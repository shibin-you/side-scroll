<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title><%=htmlWebpackPlugin.options.title%></title>
</head>

<body>
  <ul class="side-bar">
    <li class="side-bar-item active">标题1</li>
    <li class="side-bar-item">标题2</li>
    <li class="side-bar-item">标题3</li>
    <li class="side-bar-item">标题4</li>
    <li class="side-bar-item">标题5</li>
    <li class="side-bar-item">标题6</li>
  </ul>
  <ul class="content">
    <li class="content-item">1</li>
    <li class="content-item">2</li>
    <li class="content-item">3</li>
    <li class="content-item">4</li>
    <li class="content-item">5</li>
    <li class="content-item" style="height:1000px">6</li>
  </ul>
</body>
<script type="text/javascript">
  window.onready = function() {

  }
  var a = new Scroll({
    scrollListener: function() {
      for (var i = 0, len = listHeight.length ; i < len; i++) {
        if (this.scrollY >= listHeight[i] && this.scrollY < listHeight[i + 1]) {
          removeClass(sideBarItems[currentIndex], 'active')
          currentIndex = i
          addClass(sideBarItems[currentIndex], 'active')
          return
        }
        if(!listHeight[i + 1]){
          removeClass(sideBarItems[currentIndex], 'active')
          currentIndex = i
          addClass(sideBarItems[currentIndex], 'active')
          return
        }
      }
    }
  })
  var currentIndex = 0
  var sideBarItems = document.getElementsByClassName('side-bar-item')
  var contentItem = document.getElementsByClassName('content-item')
  var listHeight = []
  var height = 0
  for (var i = 0; i < sideBarItems.length; i++) {
    var item = sideBarItems[i]
    item.setAttribute('data-index', i)
    listHeight.push(height)
    height += contentItem[i].offsetHeight
    item.onclick = function() {
      var index = this.getAttribute('data-index')
      a.scrollToEl(contentItem[index])
      removeClass(sideBarItems[currentIndex], 'active')
      currentIndex = index
      addClass(this, 'active')
    }
  }

  function fnSroll() {
    a.scrollToEl(document.getElementById('wrap'))
  }

  function fnSrollTop() {
    a.scrollToTop()
  }

  function fnSrollBottom() {
    a.scrollToBottom()
  }


  function removeClass(elem, cls) {
    if (hasClass(elem, cls)) {
      var newClass = ' ' + elem.className.replace(/[\t\r\n]/g, '') + ' ';
      while (newClass.indexOf(' ' + cls + ' ') >= 0) {
        newClass = newClass.replace(' ' + cls + ' ', ' ');
      }
      elem.className = newClass.replace(/^\s+|\s+$/g, '');
    }
  }

  function addClass(el, className) {
    if (hasClass(el, className)) {
      return
    }
    var classNames = el.className.split(' ')
    classNames.push(className)
    el.className = classNames.join(' ')
  }

  function hasClass(el, className) {
    var regstr = '(^|\\s)' + className + '($|\\s)'
    var reg = new RegExp(regstr)
    return reg.test(el.className)
  }
</script>

</html>
